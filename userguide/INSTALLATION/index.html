<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=../../assets/logos/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-8.2.16"><title>Installation - Deployment Automation for Atlassian DC on Kubernetes</title><link rel=stylesheet href=../../assets/stylesheets/main.1c3799f8.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.cc9b2e1e.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-9EV9WQVD44"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-9EV9WQVD44",{page_path:e.pathname})})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-9EV9WQVD44"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary data-md-color-accent> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#installation class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <a href=https://community.atlassian.com/t5/Atlassian-Data-Center-on/gh-p/DC_Kubernetes title="Share your feedback with the Atlassian Data Center on Kubernetes Community" style=color:white><strong>Share your feedback and join the discussion</strong></a> </div> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Deployment Automation for Atlassian DC on Kubernetes" class="md-header__button md-logo" aria-label="Deployment Automation for Atlassian DC on Kubernetes" data-md-component=logo> <img src=../../assets/logos/atlassian-logo.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Deployment Automation for Atlassian DC on Kubernetes </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Installation </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary data-md-color-accent aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary data-md-color-accent aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/atlassian-labs/data-center-terraform title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> atlassian-labs/data-center-terraform </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../PREREQUISITES/ class="md-tabs__link md-tabs__link--active"> User guide </a> </li> <li class=md-tabs__item> <a href=../../troubleshooting/TROUBLESHOOTING/ class=md-tabs__link> Troubleshooting </a> </li> <li class=md-tabs__item> <a href=../../development/HOW_TO_START/ class=md-tabs__link> Development </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Deployment Automation for Atlassian DC on Kubernetes" class="md-nav__button md-logo" aria-label="Deployment Automation for Atlassian DC on Kubernetes" data-md-component=logo> <img src=../../assets/logos/atlassian-logo.svg alt=logo> </a> Deployment Automation for Atlassian DC on Kubernetes </label> <div class=md-nav__source> <a href=https://github.com/atlassian-labs/data-center-terraform title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> atlassian-labs/data-center-terraform </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2> User guide <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="User guide" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> User guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../PREREQUISITES/ class=md-nav__link> Prerequisites </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Installation <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Installation </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#1-set-up-aws-security-credentials class=md-nav__link> 1. Set up AWS security credentials </a> </li> <li class=md-nav__item> <a href=#2-clone-the-project-repository class=md-nav__link> 2. Clone the project repository </a> </li> <li class=md-nav__item> <a href=#3-configure-the-infrastructure class=md-nav__link> 3. Configure the infrastructure </a> </li> <li class=md-nav__item> <a href=#4-run-the-installation-script class=md-nav__link> 4. Run the installation script </a> </li> <li class=md-nav__item> <a href=#uninstall class=md-nav__link> Uninstall </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3> Configuration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Configuration data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Configuration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../configuration/CONFIGURATION/ class=md-nav__link> Common configuration </a> </li> <li class=md-nav__item> <a href=../configuration/BAMBOO_CONFIGURATION/ class=md-nav__link> Bamboo configuration </a> </li> <li class=md-nav__item> <a href=../configuration/BITBUCKET_CONFIGURATION/ class=md-nav__link> Bitbucket configuration </a> </li> <li class=md-nav__item> <a href=../configuration/CONFLUENCE_CONFIGURATION/ class=md-nav__link> Confluence configuration </a> </li> <li class=md-nav__item> <a href=../configuration/JIRA_CONFIGURATION/ class=md-nav__link> Jira configuration </a> </li> <li class=md-nav__item> <a href=../configuration/CROWD_CONFIGURATION/ class=md-nav__link> Crowd configuration </a> </li> <li class=md-nav__item> <a href=../configuration/DCAPT_CONFIGURATION/ class=md-nav__link> DCAPT Configuration </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../CLEANUP/ class=md-nav__link> Uninstallation </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Troubleshooting <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Troubleshooting data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Troubleshooting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../troubleshooting/TROUBLESHOOTING/ class=md-nav__link> Troubleshooting tips </a> </li> <li class=md-nav__item> <a href=../../troubleshooting/SUPPORT_BOUNDARIES/ class=md-nav__link> Support boundaries </a> </li> <li class=md-nav__item> <a href=../../troubleshooting/LIMITATIONS/ class=md-nav__link> Limitations </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Development <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Development data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Development </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../development/HOW_TO_START/ class=md-nav__link> How to start development </a> </li> <li class=md-nav__item> <a href=../../development/HOW_TO_TEST/ class=md-nav__link> Testing </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#1-set-up-aws-security-credentials class=md-nav__link> 1. Set up AWS security credentials </a> </li> <li class=md-nav__item> <a href=#2-clone-the-project-repository class=md-nav__link> 2. Clone the project repository </a> </li> <li class=md-nav__item> <a href=#3-configure-the-infrastructure class=md-nav__link> 3. Configure the infrastructure </a> </li> <li class=md-nav__item> <a href=#4-run-the-installation-script class=md-nav__link> 4. Run the installation script </a> </li> <li class=md-nav__item> <a href=#uninstall class=md-nav__link> Uninstall </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/atlassian-labs/data-center-terraform/edit/main/docs/docs/userguide/INSTALLATION.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=installation>Installation<a class=headerlink href=#installation title="Permanent link"> ¶</a></h1> <p>This guide describes how to provision the cloud environment infrastructure and install Atlassian Data Center products in a Kubernetes cluster running on AWS.</p> <h2 id=1-set-up-aws-security-credentials>1. Set up AWS security credentials<a class=headerlink href=#1-set-up-aws-security-credentials title="Permanent link"> ¶</a></h2> <p>Set up a user with an administrator IAM role. See <a class=external href=https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html>Configuration basics — AWS Command Line Interface</a>.</p> <h2 id=2-clone-the-project-repository>2. Clone the project repository<a class=headerlink href=#2-clone-the-project-repository title="Permanent link"> ¶</a></h2> <p>Clone the <code>data-center-terraform</code> project repository from GitHub:</p> <div class=highlight><pre><span></span><code>git<span class=w> </span>clone<span class=w> </span>-b<span class=w> </span><span class=m>2</span>.9.10<span class=w> </span>https://github.com/atlassian-labs/data-center-terraform.git<span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=nb>cd</span><span class=w> </span>data-center-terraform
</code></pre></div> <h2 id=3-configure-the-infrastructure>3. Configure the infrastructure<a class=headerlink href=#3-configure-the-infrastructure title="Permanent link"> ¶</a></h2> <p>Details of the desired infrastructure to be provisioned can be defined in <code>config.tfvars</code> located in the root level of the cloned project. Additional details on how this file can/should be configured can be found in the <a href=../configuration/CONFIGURATION/ >Configuration guide</a>.</p> <details class=info> <summary>Configuration file location?</summary> <p>By default, Terraform uses <code>config.tfvars</code> located in the root level of the project.</p> </details> <details class=tip> <summary>Can I use a custom configuration file?</summary> <p>You can use a custom configuration file, but it must follow the same format as the default configuration file. You can make a copy of <code>config.tfvars</code>, renaming the copy and using <code>config.tfvars</code> as a template to define your own infrastructure configuration.</p> </details> <details class=tip> <summary>How to install more than one DC product?</summary> <p>More than one DC products can be provisioned to the same cluster. See the <a href=../configuration/CONFIGURATION/#products>Configuration guide</a> for more details. You can also install DC products to an existing environment by adding the <a href=../configuration/CONFIGURATION/ >product</a> in the environment's config file and re-run the <a href=./ >install</a> command.</p> </details> <details class=warning> <summary>Use the same configuration file for uninstallation and cleanup</summary> <p>If you have more than one environment, make sure to manage the configuration file for each environment separately. When cleaning up your environment, use the same configuration file that was used to create it originally.</p> </details> <h2 id=4-run-the-installation-script>4. Run the installation script<a class=headerlink href=#4-run-the-installation-script title="Permanent link"> ¶</a></h2> <p>Based on how <code>config.tfvars</code> has been configured the installation script will </p> <ol> <li>Provision the environment and infrastructure </li> <li>Install the selected DC product(s) </li> </ol> <p>Installation is fully automated and requires no user intervention. Terraform is invoked under the hood which handles the creation and management of the Kubernetes infrastructure.</p> <details class=info> <summary>Terraform deployment details</summary> <p>To keep track of the current state of the resources and manage changes, Terraform creates an <a href=https://aws.amazon.com/s3/ class=external>AWS S3 bucket</a> to store the current state of the environment. An <a href=https://aws.amazon.com/dynamodb/ >AWS DynamoDB</a> table is created to handle the locking of remote state files during the installation, upgrade, and cleanup stages to prevent the environment from being modified by more than one process at a time. </p> <p>The installation script, <code>install.sh</code>, is located in the root folder of the project.</p> </details> <p>Usage: </p> <div class=highlight><pre><span></span><code>./install.sh<span class=w> </span><span class=o>[</span>-c<span class=w> </span>&lt;config_file_path&gt;<span class=o>]</span><span class=w> </span><span class=o>[</span>-h<span class=o>]</span>
</code></pre></div> <p>The following options are available:</p> <ul> <li><code>-c &lt;config_file_path&gt;</code> - Pass a custom configuration file when provisioning multiple environments</li> <li><code>-h</code> - Display help information</li> </ul> <div class="admonition info"> <p class=admonition-title>Using the same cloned repository to manage more than one environment</p> <p>If the repository has already been used to deploy an environment, and that environment is still active, i.e. hasn't been uninstalled yet, deploying a new environment using install.sh will get a prompt with following message: </p> <div class=highlight><pre><span></span><code>Do<span class=w> </span>you<span class=w> </span>want<span class=w> </span>to<span class=w> </span>copy<span class=w> </span>existing<span class=w> </span>state<span class=w> </span>to<span class=w> </span>the<span class=w> </span>new<span class=w> </span>backend?<span class=w> </span>Pre-existing<span class=w> </span>state<span class=w> </span>was<span class=w> </span>found<span class=w> </span><span class=k>while</span><span class=w> </span>migrating<span class=w> </span>
the<span class=w> </span>previous<span class=w> </span><span class=s2>&quot;s3&quot;</span><span class=w> </span>backend<span class=w> </span>to<span class=w> </span>the<span class=w> </span>newly<span class=w> </span>configured<span class=w> </span><span class=s2>&quot;s3&quot;</span><span class=w> </span>backend.<span class=w> </span>An<span class=w> </span>existing<span class=w> </span>non-empty<span class=w> </span>state<span class=w> </span>already<span class=w> </span>
exists<span class=w> </span><span class=k>in</span><span class=w> </span>the<span class=w> </span>new<span class=w> </span>backend.<span class=w> </span>The<span class=w> </span>two<span class=w> </span>states<span class=w> </span>have<span class=w> </span>been<span class=w> </span>saved<span class=w> </span>to<span class=w> </span>temporary<span class=w> </span>files<span class=w> </span>that<span class=w> </span>will<span class=w> </span>be<span class=w> </span>removed<span class=w> </span>
after<span class=w> </span>responding<span class=w> </span>to<span class=w> </span>this<span class=w> </span>query.<span class=w> </span>
Previous<span class=w> </span><span class=o>(</span><span class=nb>type</span><span class=w> </span><span class=s2>&quot;s3&quot;</span><span class=o>)</span>:<span class=w> </span>/var/folders/vm/sz46pmw94f3f8nrvzyqhwmx00000gn/T/terraform3661306827/1-s3.tfstate<span class=w> </span>
New<span class=w> </span><span class=o>(</span><span class=nb>type</span><span class=w> </span><span class=s2>&quot;s3&quot;</span><span class=o>)</span>:<span class=w> </span>/var/folders/vm/sz46pmw94f3f8nrvzyqhwmx00000gn/T/terraform3661306827/2-s3.tfstate<span class=w> </span>
Do<span class=w> </span>you<span class=w> </span>want<span class=w> </span>to<span class=w> </span>overwrite<span class=w> </span>the<span class=w> </span>state<span class=w> </span><span class=k>in</span><span class=w> </span>the<span class=w> </span>new<span class=w> </span>backend<span class=w> </span>with<span class=w> </span>the<span class=w> </span>previous<span class=w> </span>state?<span class=w> </span>Enter<span class=w> </span><span class=s2>&quot;yes&quot;</span><span class=w> </span>to<span class=w> </span>copy<span class=w> </span>
and<span class=w> </span><span class=s2>&quot;no&quot;</span><span class=w> </span>to<span class=w> </span>start<span class=w> </span>with<span class=w> </span>the<span class=w> </span>existing<span class=w> </span>state<span class=w> </span><span class=k>in</span><span class=w> </span>the<span class=w> </span>newly<span class=w> </span>configured<span class=w> </span><span class=s2>&quot;s3&quot;</span><span class=w> </span>backend.

Enter<span class=w> </span>a<span class=w> </span>value:
</code></pre></div> <p>This will happen everytime when you switch between different active environments. Since environemnts are independent, answer '<em>NO</em>' to continue.<br> If you answered Yes, Terraform will then use the state of active environment to plan and deploy new environment, which will pollute the state of both environments, and end up to an error state.<br> Check <a href=../../troubleshooting/TROUBLESHOOTING/ >troubleshoting</a> guide if you accidentally answered Yes. </p> </div> <p>Running the installation script with no parameters will use the default configuration file to provision the environment. </p> <div class="admonition info"> <p class=admonition-title>Installation using default and custom configuration files</p> <p>Running the installation script with no parameters will use the default configuration file (<code>config.tfvars</code>) to provision the environment:</p> <div class=highlight><pre><span></span><code>./install.sh
</code></pre></div> <p>Alternatively a custom configuration file can be specified as follows:</p> <div class=highlight><pre><span></span><code>./install.sh<span class=w> </span>-c<span class=w> </span>my-custom-config.tfvars
</code></pre></div> </div> <details class=help> <summary>How do I find the service URL of the deployed DC product?</summary> <p>When the installation process finishes successfully detailed information about the infrastructure is printed to <code>STDOUT</code>, this includes the <code>product_urls</code> value that can be used to launch the product in the browser. </p> </details> <details class=help> <summary>Where do I find the database <code>username</code> and <code>password</code>?</summary> <p>The database master <code>username</code> and <code>password</code> for each product is dynamically generated by Terraform and saved in a <a href=https://kubernetes.io/docs/concepts/configuration/secret/ class=external>Kubernetes secret</a> within the product <code>namespace</code>.</p> <p>To access the database username and password, run the following commands: <div class=highlight><pre><span></span><code>DB_SECRETS=$(kubectl get secret &lt;product-name&gt;-db-cred -n atlassian -o jsonpath=&#39;{.data}&#39;)
DB_USERNAME=$(echo $DB_SECRETS | jq -r &#39;.username&#39; | base64 --decode)
DB_PASSWORD=$(echo $DB_SECRETS | jq -r &#39;.password&#39; | base64 --decode)
</code></pre></div></p> <p>This saves the decoded username and password to the <code>$DB_USERNAME</code> and <code>$DB_PASSWORD</code> environment variables respectively.</p> </details> <h2 id=uninstall>Uninstall<a class=headerlink href=#uninstall title="Permanent link"> ¶</a></h2> <p>The deployment and all of its associated resources can be un-installed by following the <a href=../CLEANUP/ >Uninstallation and cleanup</a> guide.</p> </article> </div> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../PREREQUISITES/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Prerequisites" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Prerequisites </div> </div> </a> <a href=../configuration/CONFIGURATION/ class="md-footer__link md-footer__link--next" aria-label="Next: Common configuration" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Common configuration </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; [2021] to [2022] Atlassian and others. </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://community.atlassian.com/t5/Atlassian-Data-Center-on/gh-p/DC_Kubernetes target=_blank rel=noopener title=community.atlassian.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M152.2 236.4c-7.7-8.2-19.7-7.7-24.8 2.8L1.6 490.2c-5 10 2.4 21.7 13.4 21.7h175c5.8.1 11-3.2 13.4-8.4 37.9-77.8 15.1-196.3-51.2-267.1zM244.4 8.1c-122.3 193.4-8.5 348.6 65 495.5 2.5 5.1 7.7 8.4 13.4 8.4H497c11.2 0 18.4-11.8 13.4-21.7 0 0-234.5-470.6-240.4-482.3-5.3-10.6-18.8-10.8-25.6.1z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["search.suggest", "search.highlight", "navigation.instant", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../assets/javascripts/bundle.3a4b43e5.min.js></script> </body> </html>